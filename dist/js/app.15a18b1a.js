(function(){"use strict";var f={1796:function(f,e,t){var i=t(9242),n=t(3571),o=t.n(n),a=t(3396);function s(f,e){const t=(0,a.up)("router-view");return(0,a.wg)(),(0,a.j4)(t)}var r=t(89);const l={},c=(0,r.Z)(l,[["render",s]]);var u=c,d=t(2292);const h=(0,i.ri)(u);h.use(d.Z),h.use(o()),h.mount("#app")},6963:function(f,e,t){var i=t(4870),n=t(4336);let o={canvasState:(0,i.iH)([["#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff"],["#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff"],["#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff"],["#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff"],["#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff"],["#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff"],["#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff"],["#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff"],["#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff"],["#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff"],["#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff"],["#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff"]]),canvasStateDayn:new Array(12).fill(new Array(12).fill(1)),latestPosition:(0,i.iH)([0,0]),lastPosition:(0,i.iH)([0,0]),group2Num:(0,i.iH)(0),group1Num:(0,i.iH)(0),group1Level:(0,i.iH)(1),group2Level:(0,i.iH)(1),group1Colors:["#76eaa3","#68c889","#59a773","#488a5a","#3a6c46","#2c5132"],group2Colors:["#f6c173","#fbb958","#faa634","#fe9900","#fd8c24","#f09800"],targetSquare:(0,i.iH)([0,0]),stageHeight:0,stageWidth:0,fieldWidth:350,fieldHeight:0,fieldScale0:0,fieldX0:0,fieldY0:0,squareXnum:0,squareYnum:0,squareBorder:(0,i.iH)(0),setStageWH(){this.stageWidth=.9*window.innerWidth,this.stageHeight=.6*window.innerHeight,console.log("stageWidth:",this.stageWidth),console.log("stageHeight:",this.stageHeight)},setFieldHeight(){this.fieldHeight=this.fieldWidth/this.squareXnum*this.squareYnum,console.log("fieldHeight",this.fieldHeight)},setFieldScale0(){this.fieldScale0=.95*this.stageWidth/this.fieldWidth,this.fieldHeight*this.fieldScale0>.95*this.stageHeight&&(this.fieldScale0=.95*this.stageHeight/this.fieldHeight),console.log("fieldScale0",this.fieldScale0)},setFieldXY(){this.fieldY0=(this.stageHeight-this.fieldHeight*this.fieldScale0)/2,this.fieldX0=(this.stageWidth-this.fieldWidth*this.fieldScale0)/2,console.log("this.fieldX0",this.fieldX0),console.log("this.fieldY0",this.fieldY0)},initCanvasData(){this.setStageWH(),this.setFieldHeight(),this.setFieldScale0(),this.setFieldXY(),console.log("stage:",this.stageHeight)},configKonva:(0,i.qj)({}),fillConfigKonva(){this.configKonva.width=this.stageWidth,this.configKonva.height=this.stageHeight},configField:(0,i.qj)({draggable:!0}),fillconfigField(){this.configField.x=this.fieldX0,this.configField.y=this.fieldY0,this.configField.scaleX=this.fieldScale0,this.configField.scaleY=this.fieldScale0;let f=this.fieldX0,e=this.fieldY0;this.configField.dragBoundFunc=function(){return{x:f,y:e}}},configSquares:[],getCanvas(){n.Z.get("/canvas").then((f=>{this.canvasState.value=f.data.canvas,this.latestPosition.value=f.data.last_paint.pixel_position,this.group1Num.value=f.data.pixels_num.group_1,this.group2Num.value=f.data.pixels_num.group_2,this.squareYnum=f.data.canvas.length,this.squareXnum=f.data.canvas[0].length})).catch((f=>{console.log(f)}))},getGroupState(){n.Z.get("/group/status").then((f=>{this.group1Level.value=f.data.groups[0].level,this.group2Level.value=f.data.groups[1].level})).catch((f=>{console.log(f)}))},squareColor(f,e){return"#"==this.canvasState.value[f][e]||""==this.canvasState.value[f][e]?"#ffffff":this.canvasState.value[f][e]},checkOccupy1(f){for(let e=0;e<this.group1Colors.length;e++)if(f==this.group1Colors[e])return!0;return!1},checkOccupy2(f){for(let e=0;e<this.group2Colors.length;e++)if(f==this.group2Colors[e])return!0;return!1},setOccupy(f,e){return this.checkOccupy1(this.canvasState.value[f][e])?1:this.checkOccupy2(this.canvasState.value[f][e])?2:"#"==this.canvasState.value[f][e]||"#ffffff"==this.canvasState.value[f][e]?0:""==this.canvasState.value[f][e]?3:void console.log("检查到canavs格子的颜色不合法")},fillConfigSquares(){for(let f=0;f<this.squareYnum;f++)for(let e=0;e<this.squareXnum;e++)this.configSquares.push((0,i.qj)({x:e*this.fieldWidth/this.squareXnum,y:f*this.fieldWidth/this.squareXnum,width:this.fieldWidth/this.squareXnum,height:this.fieldWidth/this.squareXnum,fill:this.squareColor(f,e),stroke:"rgb(200, 200, 200)",strokeWidth:0,lineCap:"round",lineJoin:"bevel",name:`square${f*this.squareXnum+e}`,occupy:this.setOccupy(f,e)}));this.configSquares[this.latestPosition.value[0]*this.squareXnum+this.latestPosition.value[1]].stroke="black"}};e["Z"]=o},1591:function(f,e,t){var i=t(4336),n=t(3194);e["Z"]={getCDtime(){i.Z.get("/user/state").then((f=>{if(1==f.data.state)n.Z.CDtime.value=0;else if(0==f.data.state){let e=f.data.last_paint_time;e>16e11&&(e=Math.ceil(e/1e3));let t=e+3600,i=Math.floor(Date.now()/1e3);console.log("下一次",t),console.log("现在",i),n.Z.CDtime.value=t-i,n.Z.timeGoes()}})).catch((f=>{console.log(f)}))}}},3194:function(f,e,t){var i=t(4870);let n={weixinOpenid:(0,i.iH)("OPENIDundefined"),token:(0,i.iH)("tokenundefined"),expire:"undefined",userName:(0,i.iH)("Alex"),userImg:"userimg",CDtime:(0,i.iH)(0),group:(0,i.iH)(0),groupLevel:(0,i.iH)(1),level:(0,i.iH)(1),pixelsNum:(0,i.iH)(0),setWeixinOpenid(f){this.weixinOpenid.value=f},setToken(f){this.token.value=f},updateExpire(f){this.expire=f},timeGoes(){let f=setInterval((()=>{n.CDtime.value>0&&(n.CDtime.value-=1,console.log("cdtime left:",n.CDtime.value)),n.CDtime.value<=0&&(clearInterval(f),n.CDtime.value=0,console.log("冷却时间结束"))}),1e3)}};e["Z"]=n},4336:function(f,e,t){var i=t(6265),n=t.n(i);n().defaults.baseURL="true"=={NODE_ENV:"production",BASE_URL:"/"}.VUE_APP_develope?"http://192.168.0.105:8081/api":"/api",n().defaults.timeout=4e3,e["Z"]=n()},2292:function(f,e,t){t.d(e,{Z:function(){return wf}});var i=t(2483),n=t(3396),o=t(4870);let a=function(){let f=location.search,e={};if(-1!=f.indexOf("?")){let t=f.slice(1),i=t.split("&");for(let f=0;f<i.length;f++)e[i[f].split("=")[0]]=i[f].split("=")[1]}let t=e.code;return""!==t&&null!=t||(window.location.href="http://192.168.0.105:8081/"),t},s=function(){let f="http://192.168.0.105:8081/home",e="wx45e82dec06f16ca9";"true"=={NODE_ENV:"production",BASE_URL:"/"}.VUE_APP_develope&&(f="http://192.168.0.105:8081/home",e="wx45e82dec06f16ca9");let t=encodeURIComponent(f),i="https://open.weixin.qq.com/connect/oauth2/authorize?appid="+e+"&redirect_uri="+t+"&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect";window.location.href=i};var r=t(3194),l=t(4336),c=t(6963),u=t(1591);function d(){l.Z.get("/user/info").then((f=>{console.log(f),r.Z.userName.value=f.data.nickname,r.Z.userImg=f.data.headimgurl,r.Z.group.value=f.data.group,r.Z.level.value=f.data.user_level,r.Z.pixelsNum.value=f.data.user_pixels_num})).then((()=>{c.Z.getCanvas()})).then((()=>{c.Z.getGroupState()})).then((()=>{u.Z.getCDtime()})).then((()=>{wf.push("/game")})).catch((f=>{console.log(f)}))}const h=f=>((0,n.dD)("data-v-72a7fefe"),f=f(),(0,n.Cn)(),f),g=h((()=>(0,n._)("div",{class:"title"},"军训大对抗",-1))),v=h((()=>(0,n._)("div",{class:"discribe"},"还没想好文案，大概意思是“真的不参加一下这个游戏吗？”",-1))),p=[g,v];var m={__name:"homePage",setup(f){let e=(0,i.tv)(),t=(0,o.iH)("");t.value=a(),(0,n.bv)((()=>{console.log(t.value)}));let s=function(){let f=`/user/token?code=${t.value}`,i={};l.Z.get(f,i).then((f=>{console.log(f.data),r.Z.setWeixinOpenid(f.data.weixin_openid),r.Z.setToken(f.data.jwtoken),l.Z.defaults.headers.common.Authorization=`Bearer ${f.data.jwtoken}`,1==f.data.first_login?e.replace("/newUser/intro"):0==f.data.first_login&&d()})).catch((f=>{console.log("发生错误",f)}))};return(f,e)=>((0,n.wg)(),(0,n.iD)("div",{class:"homePage",onClick:e[0]||(e[0]=(...f)=>(0,o.SU)(s)&&(0,o.SU)(s)(...f))},p))}},_=t(89);const w=(0,_.Z)(m,[["__scopeId","data-v-72a7fefe"]]);var S=w,b=t(4462);const x={class:"homeView"};var y={__name:"homeView",setup(f){return(f,e)=>((0,n.wg)(),(0,n.iD)("div",x,[(0,n.Wm)(S),(0,n.Wm)(b.Z)]))}};const k=(0,_.Z)(y,[["__scopeId","data-v-bdb82f84"]]);var C=k;const H={class:"newUserView"};var Z={__name:"newUserView",setup(f){return console.log("已经加载了newUserView"),(f,e)=>{const t=(0,n.up)("router-view");return(0,n.wg)(),(0,n.iD)("div",H,[(0,n.Wm)(t),(0,n.Wm)(b.Z)])}}};const q=(0,_.Z)(Z,[["__scopeId","data-v-569f1ac7"]]);var D=q,O=t(9242),U=t.p+"img/loading.ef8125e7.jpg";const W=f=>((0,n.dD)("data-v-3ee9a8d4"),f=f(),(0,n.Cn)(),f),E={class:"loading"},P=W((()=>(0,n._)("img",{src:U},null,-1))),j=[P];function B(f,e){return(0,n.wg)(),(0,n.iD)("div",E,j)}const N={},T=(0,_.Z)(N,[["render",B],["__scopeId","data-v-3ee9a8d4"]]);var X=T,A={__name:"loadingView",setup(f){let e=(0,o.iH)(!1);return window.onload=function(){e.value=!0,setTimeout((()=>{e.value=!1}),2800),setTimeout((()=>{s()}),3300)},(f,t)=>((0,n.wg)(),(0,n.j4)(O.uT,{name:"a"},{default:(0,n.w5)((()=>[(0,o.SU)(e)?((0,n.wg)(),(0,n.j4)(X,{key:0})):(0,n.kq)("",!0)])),_:1}))}};const F=(0,_.Z)(A,[["__scopeId","data-v-0f12aae4"]]);var I=F,L=t(7139);const Y={class:"intrologo"},V=["src"],K={class:"introText"};var M={__name:"introBox1",props:{img:{},text:{},clickable:{},group:{}},setup(f){const e=f,{img:t,text:i,group:a}=(0,o.BK)(e);let s=function(f){if(console.log(a.value),f){let f={group:a.value};l.Z.post("/user/group",f).then((f=>{console.log(f),d()})).catch((f=>{console.log(f)}))}else console.log("fail to click")};return(e,a)=>((0,n.wg)(),(0,n.iD)("div",{class:"introBox introBox1",onClick:a[0]||(a[0]=e=>(0,o.SU)(s)(f.clickable))},[(0,n._)("div",Y,[(0,n._)("img",{src:(0,o.SU)(t)},null,8,V)]),(0,n._)("div",K,(0,L.zw)((0,o.SU)(i)),1)]))}};const z=(0,_.Z)(M,[["__scopeId","data-v-2455b8cf"]]);var G=z;const R={class:"intrologo"},$=["src"],J={class:"introText"};var Q={__name:"introBox2",props:{img:{},text:{},clickable:{},group:{}},setup(f){const e=f,{img:t,text:i,group:a}=(0,o.BK)(e);let s=function(f){if(console.log(a.value),f){let f={group:a.value};l.Z.post("/user/group",f).then((f=>{console.log(f),d()})).catch((f=>{console.log(f)}))}else console.log("fail to click")};return(e,a)=>((0,n.wg)(),(0,n.iD)("div",{class:"introBox introBox1",onClick:a[0]||(a[0]=e=>(0,o.SU)(s)(f.clickable))},[(0,n._)("div",R,[(0,n._)("img",{src:(0,o.SU)(t)},null,8,$)]),(0,n._)("div",J,(0,L.zw)((0,o.SU)(i)),1)]))}};const ff=(0,_.Z)(Q,[["__scopeId","data-v-636afa4e"]]);var ef=ff;const tf=f=>((0,n.dD)("data-v-766e24ef"),f=f(),(0,n.Cn)(),f),nf={class:"intro"},of=tf((()=>(0,n._)("div",{class:"title"},"军训大对抗",-1)));var af={__name:"introPage",setup(f){let e=(0,i.tv)(),a=()=>{e.replace("/newUser/select")},s=["他们誓当21世纪后羿，为武汉带来三分凉意。","他们是夏日西瓜爱好者，偷走夏日一抹甜凉是他们一生的追求。"];return(f,e)=>((0,n.wg)(),(0,n.iD)("div",nf,[of,(0,n.Wm)(G,{img:t(7816),text:(0,o.SU)(s)[0],clickable:!1},null,8,["img","text"]),(0,n.Wm)(ef,{img:t(463),text:(0,o.SU)(s)[1],clickable:!1},null,8,["img","text"]),(0,n._)("div",{class:"toSelect",onClick:e[0]||(e[0]=(...f)=>(0,o.SU)(a)&&(0,o.SU)(a)(...f))},"我要加入对抗!")]))}};const sf=(0,_.Z)(af,[["__scopeId","data-v-766e24ef"]]);var rf=sf;const lf=f=>((0,n.dD)("data-v-3c523268"),f=f(),(0,n.Cn)(),f),cf={class:"select"},uf=lf((()=>(0,n._)("div",{class:"title"},"军训大对抗",-1))),df=(0,n.uE)('<div class="scrollBox" data-v-3c523268><div class="gridBorder" data-v-3c523268></div><div class="scrollBar" data-v-3c523268><p class="animate" data-v-3c523268>HUST勇士，请点击选择一个阵营吧！</p></div><div class="gridBorder" data-v-3c523268></div></div>',1);var hf={__name:"selectPage",setup(f){let e=["他们誓当21世纪后羿，为武汉带来三分凉意。","他们是夏日西瓜爱好者，偷走夏日一抹甜凉是他们一生的追求。"];return(f,i)=>((0,n.wg)(),(0,n.iD)("div",cf,[uf,(0,n.Wm)(G,{img:t(7816),text:(0,o.SU)(e)[0],clickable:!0,group:2},null,8,["img","text"]),(0,n.Wm)(ef,{img:t(463),text:(0,o.SU)(e)[1],clickable:!0,group:1},null,8,["img","text"]),df]))}};const gf=(0,_.Z)(hf,[["__scopeId","data-v-3c523268"]]);var vf=gf;const pf=()=>t.e(653).then(t.bind(t,5653)),mf=[{path:"/",component:I},{path:"/home",component:C},{path:"/game",component:pf},{path:"/newUser",component:D,children:[{path:"intro",component:rf},{path:"select",component:vf}]},{path:"/:path(.*)",redirect:"/"}],_f=(0,i.p7)({history:(0,i.PO)(),routes:mf});var wf=_f},4462:function(f,e,t){t.d(e,{Z:function(){return l}});var i=t(3396);const n={class:"ad"};function o(f,e){return(0,i.wg)(),(0,i.iD)("div",n,"冰岩作坊 -点击了解我们-")}var a=t(89);const s={},r=(0,a.Z)(s,[["render",o],["__scopeId","data-v-ed915ca6"]]);var l=r},463:function(f,e,t){f.exports=t.p+"img/greenlogo.11fe652a.png"},7816:function(f,e,t){f.exports=t.p+"img/yellowlogo.8f2886e0.png"}},e={};function t(i){var n=e[i];if(void 0!==n)return n.exports;var o=e[i]={exports:{}};return f[i].call(o.exports,o,o.exports,t),o.exports}t.m=f,function(){var f=[];t.O=function(e,i,n,o){if(!i){var a=1/0;for(c=0;c<f.length;c++){i=f[c][0],n=f[c][1],o=f[c][2];for(var s=!0,r=0;r<i.length;r++)(!1&o||a>=o)&&Object.keys(t.O).every((function(f){return t.O[f](i[r])}))?i.splice(r--,1):(s=!1,o<a&&(a=o));if(s){f.splice(c--,1);var l=n();void 0!==l&&(e=l)}}return e}o=o||0;for(var c=f.length;c>0&&f[c-1][2]>o;c--)f[c]=f[c-1];f[c]=[i,n,o]}}(),function(){t.n=function(f){var e=f&&f.__esModule?function(){return f["default"]}:function(){return f};return t.d(e,{a:e}),e}}(),function(){t.d=function(f,e){for(var i in e)t.o(e,i)&&!t.o(f,i)&&Object.defineProperty(f,i,{enumerable:!0,get:e[i]})}}(),function(){t.f={},t.e=function(f){return Promise.all(Object.keys(t.f).reduce((function(e,i){return t.f[i](f,e),e}),[]))}}(),function(){t.u=function(f){return"js/"+f+".84525f54.js"}}(),function(){t.miniCssF=function(f){return"css/"+f+".ce00a123.css"}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(f){if("object"===typeof window)return window}}()}(),function(){t.o=function(f,e){return Object.prototype.hasOwnProperty.call(f,e)}}(),function(){var f={},e="bypixel:";t.l=function(i,n,o,a){if(f[i])f[i].push(n);else{var s,r;if(void 0!==o)for(var l=document.getElementsByTagName("script"),c=0;c<l.length;c++){var u=l[c];if(u.getAttribute("src")==i||u.getAttribute("data-webpack")==e+o){s=u;break}}s||(r=!0,s=document.createElement("script"),s.charset="utf-8",s.timeout=120,t.nc&&s.setAttribute("nonce",t.nc),s.setAttribute("data-webpack",e+o),s.src=i),f[i]=[n];var d=function(e,t){s.onerror=s.onload=null,clearTimeout(h);var n=f[i];if(delete f[i],s.parentNode&&s.parentNode.removeChild(s),n&&n.forEach((function(f){return f(t)})),e)return e(t)},h=setTimeout(d.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=d.bind(null,s.onerror),s.onload=d.bind(null,s.onload),r&&document.head.appendChild(s)}}}(),function(){t.r=function(f){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(f,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(f,"__esModule",{value:!0})}}(),function(){t.p="/"}(),function(){var f=function(f,e,t,i){var n=document.createElement("link");n.rel="stylesheet",n.type="text/css";var o=function(o){if(n.onerror=n.onload=null,"load"===o.type)t();else{var a=o&&("load"===o.type?"missing":o.type),s=o&&o.target&&o.target.href||e,r=new Error("Loading CSS chunk "+f+" failed.\n("+s+")");r.code="CSS_CHUNK_LOAD_FAILED",r.type=a,r.request=s,n.parentNode.removeChild(n),i(r)}};return n.onerror=n.onload=o,n.href=e,document.head.appendChild(n),n},e=function(f,e){for(var t=document.getElementsByTagName("link"),i=0;i<t.length;i++){var n=t[i],o=n.getAttribute("data-href")||n.getAttribute("href");if("stylesheet"===n.rel&&(o===f||o===e))return n}var a=document.getElementsByTagName("style");for(i=0;i<a.length;i++){n=a[i],o=n.getAttribute("data-href");if(o===f||o===e)return n}},i=function(i){return new Promise((function(n,o){var a=t.miniCssF(i),s=t.p+a;if(e(a,s))return n();f(i,s,n,o)}))},n={143:0};t.f.miniCss=function(f,e){var t={653:1};n[f]?e.push(n[f]):0!==n[f]&&t[f]&&e.push(n[f]=i(f).then((function(){n[f]=0}),(function(e){throw delete n[f],e})))}}(),function(){var f={143:0};t.f.j=function(e,i){var n=t.o(f,e)?f[e]:void 0;if(0!==n)if(n)i.push(n[2]);else{var o=new Promise((function(t,i){n=f[e]=[t,i]}));i.push(n[2]=o);var a=t.p+t.u(e),s=new Error,r=function(i){if(t.o(f,e)&&(n=f[e],0!==n&&(f[e]=void 0),n)){var o=i&&("load"===i.type?"missing":i.type),a=i&&i.target&&i.target.src;s.message="Loading chunk "+e+" failed.\n("+o+": "+a+")",s.name="ChunkLoadError",s.type=o,s.request=a,n[1](s)}};t.l(a,r,"chunk-"+e,e)}},t.O.j=function(e){return 0===f[e]};var e=function(e,i){var n,o,a=i[0],s=i[1],r=i[2],l=0;if(a.some((function(e){return 0!==f[e]}))){for(n in s)t.o(s,n)&&(t.m[n]=s[n]);if(r)var c=r(t)}for(e&&e(i);l<a.length;l++)o=a[l],t.o(f,o)&&f[o]&&f[o][0](),f[o]=0;return t.O(c)},i=self["webpackChunkbypixel"]=self["webpackChunkbypixel"]||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))}();var i=t.O(void 0,[998],(function(){return t(1796)}));i=t.O(i)})();
//# sourceMappingURL=app.15a18b1a.js.map